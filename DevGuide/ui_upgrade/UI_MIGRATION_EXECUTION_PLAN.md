# WEB_JustGolf UI 업그레이드 실행 계획서 (Stack 유지 버전)

## 0. 문서 목적
- 본 문서는 `UI_MIGRATION_PLAN.md`를 실제 구현 단계로 쪼갠 실행 계획서다.
- 목표는 **기술 스택을 유지**(`Next.js App Router + Supabase + Vercel`)하면서, 핵심 8화면의 UI/UX를 템플릿 톤으로 업그레이드하는 것이다.
- 템플릿(`UI_MIG_TEMPLET`)은 **디자인 레퍼런스**로만 사용하며, 서비스 로직/권한/데이터 흐름은 기존 프로젝트 코드를 기준으로 유지한다.

## 1. 전제 및 의사결정
1. 스택 교체는 하지 않는다.
2. URL/라우팅 구조는 유지한다.
3. Supabase 스키마/RLS/정책/API 계약은 변경하지 않는다.
4. UI는 템플릿 기반으로 재구성하되, 템플릿 미구현 영역은 기존 UI를 템플릿 톤으로 확장 구현한다.
5. 기능 우선순위는 "동작 보존 > UI 정밀도"가 아니라, **동작 100% 보존 + UI 정밀 이식**을 동시에 목표로 한다.

## 2. 변경 범위 / 비범위

### 2.1 변경 범위 (핵심 8화면)
- `/login`
- `/start`
- `/tournaments`
- `/t/[id]/participants`
- `/t/[id]`
- `/admin/tournaments`
- `/admin/tournaments/[id]/registrations`
- `/admin/tournaments/[id]/side-events`

### 2.2 비범위
- DB migration, RLS 정책 SQL 변경
- 비핵심 화면 일괄 개편 (`/board`, `/profile`, `/admin/users`, `/admin/help` 등)
- 인증 정책 자체 변경
- 신규 대규모 기능 추가

## 3. 구현 원칙

### 3.1 로직 보존 원칙
- 기존 Supabase query/mutation 흐름은 그대로 유지한다.
- 버튼/입력/저장/삭제/상태변경/다운로드 등 기존 상호작용은 모두 유지한다.
- 템플릿의 정적 목업 데이터는 사용하지 않는다.

### 3.2 권한 보존 원칙
- `middleware.ts`의 로그인/승인/온보딩/관리자 접근 통제를 유지한다.
- 관리자 화면의 admin check / manager check를 유지한다.
- 비로그인 차단, 권한 없음 메시지, 리다이렉트 동작을 변경하지 않는다.

### 3.3 UI 이식 원칙
- 템플릿의 "배치/비주얼/섹션 구조"를 이식한다.
- 템플릿 미구현 기능은 기존 기능 블록을 재배치하여 완전 기능을 보장한다.
- 공통 UI 패턴은 재사용 가능한 작은 프레젠테이션 컴포넌트로 추출한다.

## 4. 단계별 실행 계획

## Phase 0. 준비 및 기준선 고정
### 목표
- 구현 리스크를 줄이기 위한 기준선 확보

### 작업
- 템플릿 폴더 빌드 제외(완료): `tsconfig.json` exclude 유지
- 핵심 8화면 현재 스냅샷 캡처(데스크톱/모바일)
- 기존 테스트 통과 기준선 기록 (`build`, 관련 unit/e2e)

### 권한/RLS 체크
- 없음 (설정/검증 단계)

### 완료 기준
- `npm run build` 성공
- 기준선 스크린샷/검증 로그 확보

---

## Phase 1. 공통 스타일/레이아웃 기반 구축
### 목표
- 화면별 중복 없이 템플릿 톤을 일관 적용할 기반 준비

### 작업
- 공통 스타일 토큰 정리(간격/반경/표면/배지/CTA)
- 공통 프레젠테이션 컴포넌트 초안
  - `PageHeader`
  - `StatCard`
  - `SectionCard`
  - `ActionBar`
- 템플릿에서 쓰는 애니메이션/유틸 클래스 중 필요한 것만 프로젝트 스타일에 추가

### 권한/RLS 체크
- 없음 (프레젠테이션 컴포넌트만 추가)

### 완료 기준
- 공통 컴포넌트만으로 샘플 페이지 1개 렌더 검증
- 기존 기능 회귀 없음

---

## Phase 2. Header 정책 적용
### 목표
- 핵심 8화면에서 전역 Header 충돌 제거, 페이지별 헤더 구조 확정

### 작업
- `components/Header.tsx`에서 핵심 8경로 전역 Header early return 처리
- sticky/fixed top offset 충돌 조정

### 권한/RLS 체크
- Header 숨김이 접근제어에 영향을 주지 않는지 확인
- 비로그인/권한없음 리다이렉트는 middleware 기준 그대로 유지

### 완료 기준
- 핵심 8화면에서 전역 Header 미노출 확인
- 비핵심 화면은 기존 Header 정상 노출 확인

---

## Phase 3. 사용자 화면 5개 이식
### 대상
- `/login`, `/start`, `/tournaments`, `/t/[id]/participants`, `/t/[id]`

### 작업 순서
1. `/login`: 템플릿 Auth 레이아웃 적용 + 기존 로그인/회원가입/카카오/에러로그/승인 흐름 유지
2. `/start`: 카드형 빠른 이동 UX 적용 + 권한 조건 노출 유지
3. `/tournaments`: 카드형 리스트/상태 배지/CTA 적용 + 데이터 조회/내 상태 유지
4. `/t/[id]/participants`: 요약 + 섹션 네비게이션 + 공개정보 카드화
5. `/t/[id]`: 가장 복잡한 화면. 템플릿 상단 구조 + 기존 기능 섹션(제3자/활동/라운드/경품/파일) 완전 보존

### 권한/RLS 체크
- 비로그인 접근 차단 확인
- 승인 대기 사용자 분기 확인
- 본인/제3자 등록 권한 및 데이터 노출 범위 확인

### 완료 기준
- 사용자 5화면 기능 회귀 0
- 템플릿 톤 적용 + 핵심 상호작용(신청/수정/취소/저장/열기) 모두 동작

---

## Phase 4. 관리자 화면 3개 이식
### 대상
- `/admin/tournaments`
- `/admin/tournaments/[id]/registrations`
- `/admin/tournaments/[id]/side-events`

### 작업 순서
1. `/admin/tournaments`: 카드 대시보드형 재구성, 하위 액션 허브 유지
2. `/registrations`: 필터/검색/개별/일괄 상태변경 UX 개선 + 엑셀 다운로드 유지
3. `/side-events`: 설정 허브 상단 + 라운드 CRUD/신청자 조회 유지

### 권한/RLS 체크
- 관리자/매니저 권한 분기 유지
- 일반 사용자 진입 차단/안내 유지
- 대량 상태변경/삭제 액션의 권한 실패 메시지 유지

### 완료 기준
- 관리자 3화면 기능 회귀 0
- 권한별 동작 차이(관리자/매니저/일반) 정상

---

## Phase 5. 통합 안정화 및 회귀 보정
### 목표
- 시각 정합성, 접근성, 반응형, 테스트 안정성 확보

### 작업
- selector 안정화(텍스트 의존 축소, role/label/testid 보강)
- 모바일 390x844 기준 sticky/fixed 겹침 점검
- 데스크톱 CTA 가시성 점검
- 성능/렌더 경고 및 Hook Rule 점검

### 완료 기준
- `npm run build` 성공
- 핵심 테스트 통과(단위/스모크/E2E 중 변경 범위 대응)
- 콘솔 오류/Hook 위반 0

## 5. 상호작용 보존 체크리스트 (핵심)

### 5.1 사용자
- 로그인/회원가입/카카오 로그인
- 신청/수정/취소 (본인)
- 제3자 추가/수정/삭제
- 활동/식사/이동/메모 저장
- 라운드 신청/취소/옵션 선택
- 경품 지원 CRUD
- 첨부파일 열기

### 5.2 관리자
- 대회 조회/삭제(soft delete)
- 신청자 개별/일괄 상태변경
- 엑셀 다운로드
- 라운드 생성/수정/삭제
- 라운드 신청자 조회

## 6. PR 분할 전략
1. PR-1: 공통 기반 + Header 정책 + `/login`, `/start`, `/tournaments`
2. PR-2: `/t/[id]/participants`, `/t/[id]`
3. PR-3: 관리자 3화면
4. PR-4: 테스트/반응형/접근성/회귀 보정

각 PR 완료 조건:
- `npm run build` 성공
- 해당 범위 수동 QA 통과
- 권한/리다이렉트 회귀 없음

## 7. 테스트 전략

### 7.1 자동 검증
- Build: `npm run build` (게이트)
- Unit: `npm run test` (변경된 컴포넌트/라우트 중심)
- E2E: `npm run test:e2e` 중 핵심 스모크 시나리오 우선

### 7.2 수동 QA (최소)
1. 로그인 성공 후 `/start` 진입 및 카드 이동
2. `/tournaments` 목록 조회 및 상세 이동
3. `/t/[id]/participants` 섹션 이동/CTA 분기 확인
4. `/t/[id]` 신청/수정/제3자/라운드/경품/파일 확인
5. `/admin/.../registrations`, `/admin/.../side-events` 권한/CRUD 확인

## 8. 위험요소 및 대응
- 템플릿 미구현 기능 누락 위험  
  -> 상호작용 보존 체크리스트 기반으로 화면별 완료검증
- sticky/fixed 충돌 위험  
  -> Header 정책 적용 직후 모바일 우선 점검
- 테스트 깨짐 위험  
  -> role/label 중심 selector로 단계별 보강
- 스타일 과적용 위험  
  -> 공통 컴포넌트에 캡슐화, 비핵심 화면 영향 차단

## 9. 최종 수용 기준
1. 핵심 8화면 UI가 템플릿 톤으로 변경됨
2. 기존 기능/권한/데이터 처리 동일 동작
3. `npm run build` 성공
4. 주요 스모크 테스트 통과
5. 비핵심 화면 회귀 없음

